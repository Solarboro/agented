{"version":3,"file":"static/js/250.a9e8414c.chunk.js","mappings":"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","sources":["comp/payment.js","pages/product/detail/index.js","store/productStore.js","utils/http.js"],"sourcesContent":["import { LockOutlined, UserOutlined } from '@ant-design/icons';\r\nimport { App, DatePicker, Divider, Form, Input, InputNumber, Select, Switch } from \"antd\";\r\nimport dayjs from 'dayjs'\r\n\r\nexport default function usePaymentPanel({title}){\r\n\r\n    const {modal} = App.useApp();\r\n    const [form] = Form.useForm();\r\n    const content = (\r\n        <Form\r\n            size='middle'\r\n            preserve={false}\r\n            form={form}            \r\n        >\r\n\r\n          {title && <Divider>{title}</Divider>}\r\n          <Form.Item\r\n            label=\"类别\"\r\n            name=\"title\"\r\n          >\r\n            <Select\r\n              \r\n              options={[\r\n                {value: '1', label: '订金'},\r\n                {value: '2', label: '期款'},\r\n                {value: '3', label: '尾款'}\r\n                \r\n              ]}\r\n            />\r\n          </Form.Item>\r\n\r\n          <Form.Item name=\"date\" label=\"支付日期\" rules={[{type: 'object'}]} >\r\n            <DatePicker inputReadOnly  />\r\n          </Form.Item>\r\n      \r\n          <Form.Item name=\"amount\" label=\"支付金额\"  >\r\n            <InputNumber />\r\n          </Form.Item>\r\n\r\n      \r\n          <Form.Item name=\"paid\" label=\"支付状态\" valuePropName=\"checked\"  >\r\n            <Switch />\r\n          </Form.Item>\r\n        </Form>\r\n    )\r\n\r\n    return (raw, onSubmit)=>{\r\n        form.setFieldsValue(raw);\r\n        modal.confirm({\r\n            icon: true,\r\n            okText: '提交',\r\n            onOk: closeForm => {form.validateFields().then(values=>onSubmit({...raw, ...values, date: dayjs(values.date).unix()*1000}, closeForm)).catch(console.info)},\r\n            content\r\n        });\r\n    }\r\n\r\n}","import { CheckCircleOutlined, DeleteOutlined } from '@ant-design/icons';\r\nimport { Button, Divider, Popconfirm, Space, Table, Tabs } from \"antd\";\r\nimport { observer } from \"mobx-react-lite\";\r\nimport { productStore } from \"../../../store/productStore\";\r\nimport dayjs from 'dayjs';\r\nimport usePaymentPanel from '../../../comp/payment';\r\n\r\n\r\n\r\n\r\n\r\nfunction ProductDetail () {\r\n\r\n    const {id: productId, payments, sampleOrder, custOrders, materials} = productStore.product;\r\n\r\n    // payment \r\n    const paymentPanel = usePaymentPanel({title:'记录编辑'});\r\n    const {newPayment, updatePayment, deletePayment} = productStore;\r\n    const submit2NewPayment = () => {\r\n        newPayment(productId, {})\r\n    }\r\n    const submitPayment = (values, callbk) => {\r\n        updatePayment(productId, values, callbk)\r\n    }\r\n    const paymentColumns = [\r\n        {\r\n            title: '类别',\r\n            dataIndex: 'title',\r\n            key: 'title',\r\n            width: '3.5em',\r\n            render: (_, {title}) => {\r\n                switch (title) {\r\n                    case '1':\r\n                        return '定金'\r\n                    case '2':\r\n                        return '期金'\r\n                    case '3':\r\n                        return '尾款'\r\n                    default:\r\n                        return '其他'\r\n                }\r\n            }\r\n        },{\r\n            title: '支付日期',\r\n            dataIndex: 'date',\r\n            key: 'date',\r\n            render: (_, {date}) => (\r\n                dayjs(date).format(\"YYYY.MM.DD\") ? dayjs(date).format(\"YYYY.MM.DD\") : \"-\"\r\n            )\r\n\r\n        },{\r\n            title: '支付状态',\r\n            dataIndex: 'paid',\r\n            key: 'paid',\r\n            render: (_, {paid}) => (\r\n                paid ? <><CheckCircleOutlined style={{color: 'green'}} />{'已支付'}</> : <>-</> \r\n            )\r\n        },{\r\n            title: '支付金额',\r\n            dataIndex: 'amount',\r\n            key: 'amount'\r\n        },{\r\n            title: '操作',\r\n            key: 'action',\r\n            render: (_, record) => (\r\n                <Space>\r\n                    <Popconfirm\r\n                        placement=\"topRight\"\r\n                        title=\"产品移除\"\r\n                        // description={`${item.style}-${item.model}`}\r\n                        onConfirm={()=>deletePayment(productId, record.id)}\r\n                        okText=\"Yes\"\r\n                        cancelText=\"No\"\r\n                    >\r\n                        <DeleteOutlined  style={{color: 'red'}}/>\r\n                    </Popconfirm>\r\n                     \r\n                    <a onClick={()=>paymentPanel({...record, date: dayjs(record.date)}, submitPayment)}>编辑</a>\r\n                </Space>\r\n            )\r\n        },\r\n    ]\r\n\r\n\r\n    // Cust Order\r\n    const custColumns = [\r\n        {\r\n            title: '码',\r\n            dataIndex: 'size',\r\n            key: 'size',\r\n            width: '.5em'\r\n        },{\r\n            title: '胸围',\r\n            dataIndex: 's1',\r\n            key: 's1',\r\n            width: '3.5em'\r\n        },{\r\n            title: '腰围',\r\n            dataIndex: 's2',\r\n            key: 's2',\r\n            width: '3.5em'\r\n        },{\r\n            title: '衣长',\r\n            dataIndex: 's3',\r\n            key: 's3',\r\n            width: '3.5em'\r\n        },{\r\n            title: '预定',\r\n            dataIndex: 'preCount',\r\n            key: 'preCount',\r\n            width: '3.5em'\r\n        },{\r\n            title: '出厂',\r\n            dataIndex: 'actCount',\r\n            key: 'actCount',\r\n            width: '3.5em'\r\n        },{\r\n            title: '操作',\r\n            key: 'action',\r\n            render: (_, record) => (\r\n                <Space>\r\n                    <Popconfirm\r\n                        placement=\"topRight\"\r\n                        title=\"产品移除\"\r\n                        // description={`${item.style}-${item.model}`}\r\n                        onConfirm={()=>deletePayment(productId, record.id)}\r\n                        okText=\"Yes\"\r\n                        cancelText=\"No\"\r\n                    >\r\n                        <DeleteOutlined  style={{color: 'red'}}/>\r\n                    </Popconfirm>\r\n                     \r\n                    <a onClick={()=>paymentPanel({...record, date: dayjs(record.date)}, submitPayment)}>编辑</a>\r\n                </Space>\r\n            )\r\n        },\r\n    ]\r\n    //\r\n\r\nconst onChange = (key) => {\r\n    console.log(key);\r\n  };\r\n  const items = [\r\n    {\r\n      key: '1',\r\n      label: `规格 & 数量`,\r\n      children: <> \r\n            <Button onClick={submit2NewPayment}>new Payment</Button>\r\n            <Table pagination={{position:[]}}  showHeader={true} columns={custColumns} dataSource={custOrders.map(value=> ({key: `custOrders${value.id}`, ...value }) )} \r\n            \r\n                summary={\r\n                    (pageData) => {\r\n\r\n                        let totalPreCount = 0;\r\n\r\n                        pageData.forEach(\r\n                            ({preCount, actCount}) => {\r\n                                totalPreCount += preCount;\r\n                            }\r\n                        );\r\n\r\n                        return (\r\n                            <Table.Summary.Row>\r\n                                <Table.Summary.Cell index={0}>{'总'}</Table.Summary.Cell>\r\n                                <Table.Summary.Cell index={1}>-</Table.Summary.Cell>\r\n                                <Table.Summary.Cell index={2}>-</Table.Summary.Cell>\r\n                                <Table.Summary.Cell index={3}>-</Table.Summary.Cell>\r\n                                <Table.Summary.Cell index={4}>{totalPreCount}</Table.Summary.Cell>\r\n                                <Table.Summary.Cell index={5}>{totalPreCount}</Table.Summary.Cell>\r\n                            </Table.Summary.Row>\r\n                        )\r\n                    }\r\n                }\r\n            \r\n            />\r\n        </>\r\n    },\r\n    {\r\n      key: '2',\r\n      label: `物料 & 工厂`,\r\n      children: <> \r\n            <Button onClick={submit2NewPayment}>new Payment</Button>\r\n            <Table pagination={{position:[]}}  showHeader={true} columns={paymentColumns} dataSource={payments.map(value=> ({key: `paymentKey_${value.id}`, ...value }) )} />\r\n        </>\r\n    },\r\n    {\r\n      key: '3',\r\n      label: `付款记录`,\r\n      children:  <> \r\n            <Button onClick={submit2NewPayment}>new Payment</Button>\r\n            <Table pagination={{position:[]}}  showHeader={true} columns={paymentColumns} dataSource={payments.map(value=> ({key: `paymentKey_${value.id}`, ...value }) )} />\r\n        </>\r\n    },\r\n  ];\r\n\r\n    return (\r\n        <>\r\n            \r\n\r\n            <Tabs defaultActiveKey=\"1\" items={items} onChange={onChange} />\r\n\r\n\r\n        </>\r\n    )\r\n\r\n}\r\n\r\nexport default  observer (ProductDetail);\r\n","import { makeAutoObservable } from \"mobx\";\r\nimport http from \"../utils/http\";\r\n\r\nclass ProductStore{\r\n\r\n    filterTemplate = [\r\n        {key: 'pending', title: '洽谈中', value:0, color: '#3f8600'},\r\n        {key: 'studio', title: '样板中', value:0, color: '#f56a00'},\r\n        {key: 'factory', title: '投产中', value:0, color: '#f56a00'},\r\n        {key: 'paid', title: '待尾款', value:0, color: '#cf1322'},\r\n    ]\r\n    filter = 'pending'\r\n    product = {}\r\n    products = []\r\n    constructor(){\r\n        makeAutoObservable(this)\r\n    }\r\n\r\n\r\n    // snap\r\n    selectd = (object) => {\r\n        this.product = {...object}\r\n    }\r\n\r\n\r\n    updateFilter = value => this.filter = value\r\n\r\n    get getFilterTemplate(){\r\n\r\n        this.filterTemplate.forEach(\r\n            value => {\r\n                value.value = this.products.filter(item => item.productStatus === value.key).length;\r\n            }\r\n        )\r\n\r\n        return this.filterTemplate;\r\n    }\r\n\r\n    new = () => {\r\n        http.post('product', {})\r\n        .then(res => {\r\n            this.products = [...this.products, res.data]\r\n        })\r\n        .catch(console.log);\r\n    }\r\n\r\n    index = () => {\r\n\r\n        http.get('product')\r\n        .then(res => {\r\n            this.products = [...res.data]\r\n            // message.info('success')\r\n        })\r\n        .catch(error => {\r\n            console.log(error)\r\n            // message.error(error?.response?.data?.message);\r\n        })\r\n    }\r\n\r\n\r\n    del = (id) => {\r\n        http.delete(`product/${id}`).then(\r\n            res => this.products.splice(this.products.findIndex(value=>value.id === id),1)\r\n        )\r\n    }\r\n\r\n    getByFilter = () => {\r\n\r\n        let listfilter = this.products.filter(item => item.productStatus === this.filter);\r\n        switch (this.filter) {\r\n            case 'pending':\r\n                return listfilter.sort((a,b)=> a.cdate - b.cdate);\r\n            case 'studio':\r\n                return listfilter.sort((a,b) => a.sampleOrder.manufactureDates - b.sampleOrder.manufactureDates)\r\n            case 'factory':\r\n                return listfilter.sort((a,b) => a.mdate - b.mdate)\r\n            \r\n            default:\r\n                return listfilter\r\n        }\r\n\r\n        \r\n    }\r\n    // Payment \r\n    newPayment = (productId, requestBody) => {\r\n        http.post(`product/${productId}/payment`, {...requestBody})\r\n        .then(res=>{\r\n            \r\n            for (const iterator of this.products) {\r\n                if(iterator.id === productId)\r\n                    iterator.payments.push({...res.data})\r\n            }\r\n\r\n          \r\n        })\r\n        .catch(console.error);\r\n    }\r\n\r\n    updatePayment = (productId, requestBody, callbk) => {\r\n        http.put(`product/${productId}/payment`, {...requestBody})\r\n        .then(res=>{\r\n            \r\n            const payment = res.data;\r\n            for (const iterator of this.products) {\r\n                if(iterator.id === productId){\r\n                    let index = iterator.payments.findIndex(value => value.id === payment.id);\r\n                    iterator.payments.splice(index, 1, {...payment})\r\n\r\n                }\r\n\r\n            }\r\n            //\r\n            callbk();\r\n        })\r\n        .catch(console.error);\r\n    }\r\n\r\n    deletePayment = (productId, paymentId) => {\r\n        http.delete(`product/${productId}/payment/${paymentId}`)\r\n        .then(res=>{\r\n\r\n            for (const iterator of this.products) {\r\n                if(iterator.id === productId){\r\n                    let index = iterator.payments.findIndex(value => value.id === paymentId);\r\n                    iterator.payments.splice(index, 1)\r\n                }\r\n            }\r\n           \r\n        })\r\n        .catch(console.error);\r\n    }\r\n\r\n    // payment\r\n\r\n\r\n}\r\n\r\nexport const productStore = new ProductStore()","import axios from \"axios\";\r\n\r\n\r\n\r\n\r\nconst http = axios.create({\r\n    baseURL: process.env.REACT_APP_BE_API,\r\n    timeout: 3000\r\n});\r\n\r\n\r\nhttp.interceptors.request.use(\r\n    config => {\r\n\r\n        console.info(config)\r\n        // append access token\r\n        if(localStorage.getItem('API_KEY') && config.url !== 'login')\r\n            config.headers.Authorization = `Bearer ${localStorage.getItem('API_KEY')}`\r\n\r\n        // todo\r\n        return config;\r\n    },\r\n    error => {\r\n  \r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\nhttp.interceptors.response.use(\r\n    response => {\r\n   \r\n        return response;\r\n    },\r\n    error => {\r\n        console.info(\"start\")\r\n        console.info(error)\r\n        console.info(\"end\")\r\n     \r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\nexport default http"],"names":["usePaymentPanel","_ref","title","modal","App","_Form$useForm","Form","form","_slicedToArray","content","_jsxs","size","preserve","children","_jsx","Divider","label","name","Select","options","value","rules","type","DatePicker","inputReadOnly","InputNumber","valuePropName","Switch","raw","onSubmit","setFieldsValue","confirm","icon","okText","onOk","closeForm","validateFields","then","values","_objectSpread","date","dayjs","unix","catch","console","info","observer","_productStore$product","productStore","productId","id","payments","custOrders","sampleOrder","paymentPanel","materials","newPayment","updatePayment","deletePayment","submit2NewPayment","submitPayment","callbk","paymentColumns","dataIndex","key","width","render","_","_ref2","format","_ref3","paid","_Fragment","CheckCircleOutlined","style","color","record","Space","Popconfirm","placement","onConfirm","cancelText","DeleteOutlined","onClick","custColumns","items","Button","Table","pagination","position","showHeader","columns","dataSource","map","concat","summary","pageData","totalPreCount","forEach","_ref4","preCount","actCount","index","Tabs","defaultActiveKey","onChange","log","ProductStore","_this","_classCallCheck","filterTemplate","filter","product","products","selectd","object","updateFilter","new","http","res","_toConsumableArray","data","error","del","splice","findIndex","getByFilter","listfilter","item","productStatus","sort","a","b","cdate","manufactureDates","mdate","requestBody","_step","_iterator","_createForOfIteratorHelper","s","n","done","iterator","push","err","e","f","_step2","payment","_iterator2","paymentId","_step3","_iterator3","makeAutoObservable","this","_createClass","get","_this2","length","axios","baseURL","process","timeout","interceptors","request","use","config","localStorage","getItem","url","headers","Authorization","Promise","reject","response"],"sourceRoot":""}